import{c as Ae,j as e,u as de,a as Me,b as He,d as ue,e as _e,p as We}from"./index-DybTJKlw.js";import{r as n,R as Pe,e as Ue,f as Be,L as we,h as Fe}from"./react-vendor-Byl6S4M9.js";import{K as ge,S as Ke,L as Ye,I as ye,T as $e}from"./canvas-vendor-C8lZMoyO.js";import{A as ve,S as Ie,H as Ve,a as Ge,T as qe}from"./Toast-DU4BSdbs.js";import{t as Je,a as Qe}from"./analytics-o4OqUApf.js";import{M as Ze,P as et}from"./plus-AqgoVZl9.js";import"./auth-vendor-Cg5HAGal.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=Ae("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=Ae("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),E={CONTAINER_MAX_WIDTH:600,CONTAINER_MAX_HEIGHT:700,ARTWORK_MAX_WIDTH:500,ARTWORK_MAX_HEIGHT:500,ARTWORK_MIN_SIZE:50,ARTWORK_MAX_RESIZE:800,EXPORT_PIXEL_RATIO_HIGH:3,EXPORT_PIXEL_RATIO_MEDIUM:2,EXPORT_PIXEL_RATIO_LOW:1,EXPORT_QUALITY_HIGH:1,EXPORT_QUALITY_MEDIUM:.9,EXPORT_QUALITY_LOW:.8},me={FRONT:{minX:103,maxX:493,minY:100,maxY:550},BACK:{minX:140,maxX:510,minY:100,maxY:550},NECK:{minX:520,maxX:1080,minY:560,maxY:710}},Ne=n.forwardRef(({tshirtColor:v="white",artworks:_=[],onArtworkPositionChange:H,onArtworkDelete:W,view:w="front"},B)=>{const[A,D]=n.useState(null),[F,K]=n.useState([]),[z,L]=n.useState(null),Y=n.useRef([]),G=n.useRef(null),x=n.useRef(null),q=n.useRef({front:null,back:null,neck:null}),R=n.useRef("front"),[$,V]=n.useState({width:550,height:650});n.useImperativeHandle(B,()=>({downloadImage:async()=>{if(!x.current)return;L(null);const o=x.current,r=o.width(),a=o.height(),u=new ge.Layer,l=new window.Image;l.crossOrigin="anonymous",await new Promise(c=>{l.onload=()=>{const b=l.height/l.width*40,h=(r-40)/2,T=a-b-20,C=new ge.Image({image:l,x:h,y:T,width:40,height:b,opacity:1});u.add(C);const j=new ge.Text({x:0,y:T+b+3,width:r,text:"stolentee.com",fontSize:8,fontFamily:"Arial, sans-serif",fill:"#000000",align:"center",opacity:1});u.add(j),c()},l.src="/assets/stolentee-logo.png"}),o.add(u),u.moveToTop();const p=o.toDataURL({pixelRatio:E.EXPORT_PIXEL_RATIO_HIGH,mimeType:"image/png",quality:E.EXPORT_QUALITY_HIGH});u.destroy();const i=document.createElement("a");i.download="tshirt-design.png",i.href=p,document.body.appendChild(i),i.click(),document.body.removeChild(i)},getThumbnail:()=>x.current?x.current.toDataURL({pixelRatio:E.EXPORT_PIXEL_RATIO_LOW,mimeType:"image/png",quality:E.EXPORT_QUALITY_LOW}):null,captureImage:()=>x.current?(L(null),x.current.toDataURL({pixelRatio:E.EXPORT_PIXEL_RATIO_MEDIUM,mimeType:"image/png",quality:E.EXPORT_QUALITY_MEDIUM})):null,getThumbnailBlob:async()=>{if(!x.current)return null;const o=x.current.toDataURL({pixelRatio:E.EXPORT_PIXEL_RATIO_LOW,mimeType:"image/png",quality:E.EXPORT_QUALITY_LOW});return await(await fetch(o)).blob()},deselect:()=>{L(null)}}));const J=o=>{const r=o.toLowerCase();return r==="navy"?{front:"/assets/navy-front.png",back:"/assets/navy-back.png",neck:"/assets/navy-neck.png"}:r==="black"?{front:"/assets/black-front.png",back:"/assets/black-back.png",neck:"/assets/black-neck.png"}:{front:"/assets/blank-tshirt.png",back:"/assets/back-tshirt.jpeg",neck:"/assets/neck-tshirt.jpeg"}};n.useEffect(()=>{const o=a=>new Promise(u=>{const l=new window.Image;l.src=a,l.crossOrigin="anonymous",l.onload=()=>u(l),l.onerror=()=>u(l)}),r=J(v);Promise.all([o(r.front),o(r.back),o(r.neck)]).then(([a,u,l])=>{q.current={front:a,back:u,neck:l};const p=w==="neck"?l:w==="back"?u:a;if(w==="neck"){const i=p.width/p.height,c=1600,I=950;let b=c,h=b/i;h<I&&(h=I,b=h*i),V({width:b,height:h})}else{const i=p.width/p.height,c=600,I=700;let b=c,h=c/i;if(h>I&&(h=I,b=I*i),w==="back"){const T=v?.toLowerCase()||"";T==="white"||T===""?(b=b*1.1,h=h*1.1):T==="navy"&&(b=b*1.02,h=h*1.02)}V({width:b,height:h})}D(p)})},[v,w]),n.useEffect(()=>{if(w===R.current)return;const o=q.current,r=w==="neck"?o.neck:w==="back"?o.back:o.front;if(r){if(w==="neck"){const a=r.width/r.height,u=1600,l=950;let p=u,i=p/a;i<l&&(i=l,p=i*a),V({width:p,height:i})}else{const a=r.width/r.height;let u=E.CONTAINER_MAX_WIDTH,l=E.CONTAINER_MAX_WIDTH/a;if(l>E.CONTAINER_MAX_HEIGHT&&(l=E.CONTAINER_MAX_HEIGHT,u=E.CONTAINER_MAX_HEIGHT*a),w==="back"){const p=v?.toLowerCase()||"";p==="white"||p===""?(u=u*1.1,l=l*1.1):p==="navy"&&(u=u*1.02,l=l*1.02)}V({width:u,height:l})}D(r),R.current=w}},[w]),n.useEffect(()=>{const o=r=>{if((r.key==="Delete"||r.key==="Backspace")&&z&&W){const a=parseInt(z.split("-")[1]);isNaN(a)||(W(a),L(null))}};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[z,W]);const P=n.useRef(new Map),Q=o=>{const r=document.createElement("canvas"),a=r.getContext("2d");if(!a)return o;r.width=o.width,r.height=o.height,a.drawImage(o,0,0);const l=a.getImageData(0,0,r.width,r.height).data;let p=r.width,i=r.height,c=0,I=0;for(let S=0;S<r.height;S++)for(let U=0;U<r.width;U++)l[(S*r.width+U)*4+3]>0&&(U<p&&(p=U),U>c&&(c=U),S<i&&(i=S),S>I&&(I=S));if(p>c||i>I)return o;const b=5;p=Math.max(0,p-b),i=Math.max(0,i-b),c=Math.min(r.width-1,c+b),I=Math.min(r.height-1,I+b);const h=c-p+1,T=I-i+1,C=document.createElement("canvas");C.width=h,C.height=T;const j=C.getContext("2d");if(!j)return o;j.drawImage(o,p,i,h,T,0,0,h,T);const M=new window.Image;return M.src=C.toDataURL("image/png"),M};n.useEffect(()=>{if(_.length===0){K([]),L(null),Y.current=[];return}(async()=>{const r=_.map(a=>{const u=P.current.get(a.url);return u?Promise.resolve(u):new Promise((l,p)=>{const i=new window.Image;i.src=a.url,i.crossOrigin="anonymous",i.onload=()=>{const c=Q(i);c.complete?(P.current.set(a.url,c),l(c)):(c.onload=()=>{P.current.set(a.url,c),l(c)},c.onerror=()=>{P.current.set(a.url,i),l(i)})},i.onerror=p})});try{const a=await Promise.all(r);K(a),Y.current=new Array(a.length).fill(null);const u=_[_.length-1];u&&!u.position&&L(`artwork-${_.length-1}`)}catch(a){console.error("Failed to load artworks:",a)}})()},[_]),n.useEffect(()=>{if(z&&G.current){const o=parseInt(z.split("-")[1]),r=Y.current[o];r&&(G.current.nodes([r]),G.current.getLayer()?.batchDraw())}},[z]);const N=o=>{const r=Y.current[o];r&&H&&H({x:r.x(),y:r.y(),scaleX:r.scaleX(),scaleY:r.scaleY(),rotation:r.rotation()},o)},Z=o=>{const r=o.target===o.target.getStage(),a=o.target.image===A;(r||a)&&L(null)};return e.jsx("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:e.jsxs("div",{className:"relative flex items-center justify-center",style:{transform:typeof window<"u"&&window.innerWidth<640?`scale(${Math.min(window.innerWidth/600,1)})`:"scale(1)",transformOrigin:"center center"},children:[F.length>0&&z&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-black/80 text-white text-xs px-4 py-2 rounded-full z-10",children:"Drag to move • Corners to resize • Rotate to spin • Click away to finish"}),F.length>0&&!z&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-gray-800/60 text-white text-xs px-4 py-2 rounded-full z-10",children:"Click artwork to edit position and size"}),e.jsx(Ke,{ref:x,width:$.width,height:$.height,onMouseDown:Z,onTouchStart:Z,children:e.jsxs(Ye,{children:[A&&e.jsx(ye,{image:A,x:0,y:0,width:$.width,height:$.height,onClick:()=>L(null),onTap:()=>L(null),...w==="neck"?{crop:{x:0,y:0,width:A.width,height:A.height}}:{}}),F.map((o,r)=>{const a=_[r];if(!a)return null;const u=o.width/o.height;let l=E.ARTWORK_MAX_WIDTH,p=E.ARTWORK_MAX_WIDTH/u;return p>E.ARTWORK_MAX_HEIGHT&&(p=E.ARTWORK_MAX_HEIGHT,l=E.ARTWORK_MAX_HEIGHT*u),e.jsxs(Pe.Fragment,{children:[e.jsx(ye,{ref:i=>{Y.current[r]=i},image:o,x:a.position?.x??(w==="neck"?750:200+r*20),y:a.position?.y??(w==="neck"?500:250+r*20),width:l,height:p,scaleX:a.position?.scaleX??1,scaleY:a.position?.scaleY??1,rotation:a.position?.rotation??0,draggable:!0,dragBoundFunc:i=>{const c=w==="neck"?me.NECK:w==="back"?me.BACK:me.FRONT,I=Y.current[r];if(!I)return i;const b=I.getClientRect(),h=b.width,T=b.height;let C=i.x,j=i.y;const M=b.x-I.x(),S=b.y-I.y();return C+M<c.minX&&(C=c.minX-M),C+M+h>c.maxX&&(C=c.maxX-h-M),j+S<c.minY&&(j=c.minY-S),j+S+T>c.maxY&&(j=c.maxY-T-S),{x:C,y:j}},onClick:()=>L(`artwork-${r}`),onTap:()=>L(`artwork-${r}`),onDragEnd:()=>N(r),onTransformEnd:()=>N(r)}),z===`artwork-${r}`&&e.jsx($e,{ref:G,keepRatio:!0,boundBoxFunc:(i,c)=>c.width<E.ARTWORK_MIN_SIZE||c.height<E.ARTWORK_MIN_SIZE||c.width>E.ARTWORK_MAX_RESIZE||c.height>E.ARTWORK_MAX_RESIZE?i:c,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],rotateEnabled:!0,borderStroke:"#000000",borderStrokeWidth:2,anchorSize:12,anchorStroke:"#000000",anchorFill:"#ffffff",anchorCornerRadius:6})]},`artwork-${r}`)})]})})]})})});Ne.displayName="TShirtCanvas";const Te=12.98,rt=5,ot=(v,_,H,W)=>{let w=W;return[v,_].filter(Boolean).length===2&&(w+=rt),w},Ee=["S","M","L","XL","2XL","3XL"],se=4,at="http://localhost:3000",re=v=>v?v.startsWith("http")?v:`${at}${v}`:"",je=["This is AI-powered extraction. Multiple attempts may be needed for perfect results.","Brand names may be altered due to copyright restrictions and AI safety filters.","Complex designs with multiple layers may require several tries to extract perfectly.","Trademarked logos and brand text might be regenerated differently by the AI."];function nt({product:v,variants:_}){const H=Ue(),W=de(s=>s.addItem),w=de(s=>s.updateItem),B=de(s=>s.getItem),A=n.useRef(null),{isAuthenticated:D}=Me(),[F]=Be(),[K,z]=n.useState(null),[L,Y]=n.useState(null),G=n.useRef(null),[x,q]=n.useState(""),[R,$]=n.useState(""),[V,J]=n.useState(null),[P,Q]=n.useState(1),[N,Z]=n.useState("front"),[o,r]=n.useState([]),[a,u]=n.useState([]),[l,p]=n.useState(null),[i,c]=n.useState(null),[I,b]=n.useState("front"),[h,T]=n.useState("idle"),[C,j]=n.useState(null),[M,S]=n.useState({message:"",percent:0}),[U,he]=n.useState(0),[Se,pe]=n.useState(!1),[oe,ae]=n.useState(""),[Le,ee]=n.useState(!1),[Re,te]=n.useState("");n.useEffect(()=>{Je(v.title)},[]),n.useEffect(()=>{if(h==="uploading"||h==="processing"){const s=setInterval(()=>{he(t=>(t+1)%je.length)},4e3);return()=>clearInterval(s)}},[h]);const ne=()=>N==="front"?o:N==="back"?a:[],ie=ne()[0]||null,fe=ot(o.length>0,a.length>0,!1,Te),le=[...new Set(_.map(s=>s.color))],Oe=le.includes("Navy")?le:[...le,"Navy"],Ce=[...new Set(_.map(s=>s.size))].sort((s,t)=>Ee.indexOf(s)-Ee.indexOf(t));n.useEffect(()=>{if(x&&R){const s=_.find(t=>t.color===x&&t.size===R);J(s||null)}},[x,R,_]),n.useEffect(()=>{const s=F.get("designId");s&&D&&_.length>0&&G.current!==s&&(G.current=s,De(s))},[F,D,_]),n.useEffect(()=>{const s=F.get("editCartItem");if(s){const t=B(s);t&&(Y(s),q(t.variantColor),$(t.variantSize),Q(t.quantity),t.customization&&(t.customization.frontArtworks&&r(t.customization.frontArtworks),t.customization.backArtworks&&u(t.customization.backArtworks),t.customization.neckArtwork&&p(t.customization.neckArtwork)))}},[F,B]),n.useEffect(()=>{if(!i||h!=="processing")return;let s=15,t=null,d=null,y=!0;const m=()=>{y=!1,t&&(clearInterval(t),t=null),d&&(clearInterval(d),d=null)};return t=setInterval(async()=>{if(!y){m();return}try{const g=await He.getStatus(i);if(console.log("Job status:",g),g.status==="running"&&g.logs){const k=g.logs.toLowerCase();k.includes("step 1")||k.includes("gemini")?s=35:k.includes("step 2")||k.includes("background")?s=60:k.includes("step 3")||k.includes("dpi")?s=80:(k.includes("step 4")||k.includes("verifying"))&&(s=95)}if(g.status==="done"){T("done"),S({message:"Complete!",percent:100}),m();const k=g.assets?.find(f=>f.kind==="transparent");if(k){const O={url:re(k.file_url),position:null,assetId:k.id};I==="back"?a.length>=se?j(`Maximum ${se} artworks per view. Remove one first.`):u(X=>[...X,O]):o.length>=se?j(`Maximum ${se} artworks per view. Remove one first.`):r(X=>[...X,O])}}else g.status==="failed"&&(T("error"),j(g.errorMessage||"Extraction failed"),m())}catch(g){console.error("Failed to poll job status:",g),console.error("Error details:",g.response?.data||g.message),T("error"),j(g.response?.data?.message||g.message||"Failed to check extraction status"),m()}},2e3),d=setInterval(()=>{if(!y){m();return}S(g=>{if(g.percent<s){const k=Math.min(2,s-g.percent);return{message:"Stealing your t-shirt",percent:g.percent+k}}return g})},100),m},[i,h]);const De=async s=>{try{const t=await ue.getById(s);console.log("[LOAD] Full design object:",JSON.stringify(t,null,2)),z(t.id),ae(t.name);const d=t.artwork_ids||[],y=t.artwork_urls||{};let m=0;if(t.design_data){if(t.design_data.front&&t.design_data.front.length>0){const f=t.design_data.front.map(O=>{const X=d[m],ce=X?re(y[X]):"";return m++,{url:ce||"",position:O,assetId:X}});r(f)}if(t.design_data.back&&t.design_data.back.length>0){const f=t.design_data.back.map(O=>{const X=d[m],ce=X?re(y[X]):"";return m++,{url:ce||"",position:O,assetId:X}});u(f)}if(t.design_data.neck&&t.design_data.neck.length>0){const f=d[m],O=f?re(y[f]):"";p({url:O||"",position:t.design_data.neck[0],assetId:f})}}console.log("[LOAD] Design variant_id:",t.variant_id),console.log("[LOAD] Design variant_color:",t.variant_color),console.log("[LOAD] Design variant_size:",t.variant_size),console.log("[LOAD] Design data color/size:",t.design_data?.selectedColor,t.design_data?.selectedSize);let g=null,k=null;if(t.design_data?.selectedColor){console.log("[LOAD] Using color from design_data (highest priority):",t.design_data.selectedColor),g=t.design_data.selectedColor,k=t.design_data.selectedSize||"M";const f=_.find(O=>O.color===g&&O.size===k);f?(console.log("[LOAD] Found matching variant for design_data color:",f),J(f)):console.log("[LOAD] No variant found for color:",g,"(UI-only color like Navy)")}else if(t.variant_id){let f=_.find(O=>O.id===t.variant_id);console.log("[LOAD] Found variant by ID:",f),!f&&t.variant_color&&t.variant_size&&(console.log("[LOAD] Variant ID not found, trying color/size lookup:",t.variant_color,t.variant_size),f=_.find(O=>O.color===t.variant_color&&O.size===t.variant_size),console.log("[LOAD] Found variant by color/size:",f)),f?(console.log("[LOAD] Setting color/size/variant from variant:",f.color,f.size),g=f.color,k=f.size,J(f)):t.variant_color&&(console.log("[LOAD] No variant found, using color from JOIN:",t.variant_color),g=t.variant_color,k=t.variant_size)}g&&(q(g),$(k||"M"))}catch(t){console.error("Error loading design:",t),alert("Failed to load design")}},ze=async s=>{const t=s.target.files?.[0];if(t){j(null);try{b(N),T("uploading"),S({message:"Uploading your image...",percent:5});const{asset:d,jobId:y,message:m}=await _e.uploadShirtPhoto(t);console.log("Shirt photo uploaded:",{asset:d,jobId:y,message:m}),c(y),T("processing"),S({message:"Starting extraction process...",percent:15}),s.target.value=""}catch(d){console.error("Shirt photo upload failed:",d),T("error"),j(d.response?.data?.message||"Failed to upload shirt photo"),s.target.value=""}}},xe=async()=>{A.current&&A.current.downloadImage&&await A.current.downloadImage()},be=async()=>{if(!D){H("/login",{state:{from:window.location.pathname+window.location.search}});return}if(K&&oe){try{await ke(oe),te("Design updated successfully!"),ee(!0),setTimeout(()=>ee(!1),3e3)}catch(s){console.error("Error updating design:",s),alert("Failed to update design")}return}pe(!0)},ke=async s=>{try{const t={front:o.map(m=>m.position),back:a.map(m=>m.position),neck:l?[l.position]:[],selectedColor:x,selectedSize:R||"M"},d=[...o.filter(m=>m.assetId).map(m=>m.assetId),...a.filter(m=>m.assetId).map(m=>m.assetId),...l?.assetId?[l.assetId]:[]];let y="";if(A.current&&A.current.getThumbnailBlob)try{const m=await A.current.getThumbnailBlob();if(m){const g=new File([m],"thumbnail.png",{type:"image/png"});y=(await _e.uploadFile(g)).file_url}}catch(m){console.error("Failed to capture thumbnail:",m)}if(K){const m=R||"M",g=V||(x?_.find(k=>k.color===x&&k.size===m):null);console.log("[SAVE] Updating design with variant:",{variantId:g?.id,color:x,size:R,variant:g}),await ue.update(K,{name:s,variantId:g?.id,designData:t,artworkIds:d,thumbnailUrl:y}),ae(s)}else{const m=R||"M",g=V||(x?_.find(f=>f.color===x&&f.size===m):null);console.log("[SAVE] Saving new design with variant:",{variantId:g?.id,color:x,size:R,variant:g});const k=await ue.save({name:s,productId:v.id,variantId:g?.id,designData:t,artworkIds:d,thumbnailUrl:y});z(k.id),ae(s),Qe(s)}}catch(t){throw console.error("Error saving design:",t),t}},Xe=()=>{if(!x||!R){te("Please select a color and size"),ee(!0);return}let s;try{A.current&&A.current.captureImage&&(s=A.current.captureImage())}catch(y){console.error("Error capturing mockup:",y)}const t=V||{id:`temp-${x}-${R}`},d={id:L||`${t.id}-${Date.now()}`,variantId:t.id,productTitle:v.title,variantColor:x,variantSize:R,quantity:P,unitPrice:fe,customization:{method:"dtg",frontArtworks:o,backArtworks:a,neckArtwork:l},mockupUrl:s};L?(w(L,d),te("Cart item updated successfully!")):(W(d),te("Added to cart successfully!")),ee(!0),setTimeout(()=>{H("/cart")},1500)};return e.jsxs("div",{className:"min-h-screen bg-white pb-24 md:pb-0",children:[e.jsx("div",{className:"border-b border-gray-200 bg-white sticky top-0 z-50",children:e.jsxs("div",{className:"relative px-4 py-3 flex items-center justify-between md:justify-center",children:[e.jsx(we,{to:"/",className:"md:hidden p-2 -ml-2 text-gray-600 hover:text-gray-900 rounded-full hover:bg-gray-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m15 18-6-6 6-6"})})}),e.jsx("div",{className:"text-base font-bold text-center md:absolute md:left-6 md:text-sm",children:v.title}),e.jsx(we,{to:"/",className:"hidden md:block absolute left-1/2 -translate-x-1/2 text-lg font-bold hover:text-gray-600 transition-colors",children:"Stolen Tee"}),e.jsxs("div",{className:"hidden md:flex items-center gap-3 absolute right-6",children:[e.jsx("button",{onClick:xe,disabled:!ie,title:"Download Design",className:`p-2 rounded-md transition-colors ${ie?"text-gray-700 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,children:e.jsx(ve,{size:18})}),e.jsxs("button",{onClick:be,className:"flex items-center gap-1.5 px-4 py-1.5 text-xs font-medium rounded-md transition-colors bg-black text-white hover:bg-gray-800",children:[e.jsx(Ie,{size:14}),e.jsx("span",{children:K?"Update":"Save"})]}),e.jsxs("div",{className:"text-sm font-normal whitespace-nowrap",children:["from $",Te.toFixed(2)]})]}),e.jsx("div",{className:"md:hidden w-10"})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row h-auto md:h-[calc(100vh-60px)]",children:[e.jsxs("div",{className:"w-full md:w-3/4 bg-gray-50 md:bg-white flex flex-col relative overflow-hidden order-1 md:order-2 h-[60vh] md:h-auto shrink-0",children:[e.jsx("div",{className:"h-full flex items-center justify-center pt-4 pb-12 px-4",children:v.slug==="classic-hoodie"?e.jsx(Ve,{ref:A,artworks:ne(),view:N,onArtworkPositionChange:(s,t)=>{if(N==="front"){const d=[...o];d[t]={...d[t],position:s},r(d)}else if(N==="back"){const d=[...a];d[t]={...d[t],position:s},u(d)}},onArtworkDelete:s=>{if(N==="front"){const t=o.filter((d,y)=>y!==s);r(t)}else if(N==="back"){const t=a.filter((d,y)=>y!==s);u(t)}}}):e.jsx(Ne,{ref:A,tshirtColor:x,artworks:ne(),view:N,onArtworkPositionChange:(s,t)=>{if(N==="front"){const d=[...o];d[t]={...d[t],position:s},r(d)}else if(N==="back"){const d=[...a];d[t]={...d[t],position:s},u(d)}},onArtworkDelete:s=>{if(N==="front"){const t=o.filter((d,y)=>y!==s);r(t)}else if(N==="back"){const t=a.filter((d,y)=>y!==s);u(t)}}})}),e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-white/90 backdrop-blur-sm rounded-full shadow-sm border border-gray-200 p-1 flex gap-1 z-10",children:[e.jsx("button",{onClick:()=>Z("front"),className:`px-5 py-1.5 rounded-full text-sm font-medium transition-all ${N==="front"?"bg-black text-white shadow-md":"text-gray-600 hover:bg-gray-100"}`,children:"Front"}),e.jsx("button",{onClick:()=>Z("back"),className:`px-5 py-1.5 rounded-full text-sm font-medium transition-all ${N==="back"?"bg-black text-white shadow-md":"text-gray-600 hover:bg-gray-100"}`,children:"Back"})]})]}),e.jsx("div",{className:"w-full md:w-1/4 bg-white border-r border-gray-200 overflow-y-auto order-2 md:order-1",children:e.jsxs("div",{className:"p-6 space-y-8 pb-32 md:pb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Upload & Extract Design"}),e.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Upload a photo and we'll extract the design using AI"}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg flex gap-2 items-start",children:[e.jsx("div",{className:"text-blue-500 mt-0.5",children:e.jsx(st,{size:16})}),e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"AI extraction may require multiple tries for best results"})]}),e.jsxs("div",{className:"border-2 border-dashed border-blue-300 bg-blue-50/30 rounded-xl p-8 text-center hover:bg-blue-50 transition-colors cursor-pointer relative group",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/png",onChange:ze,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",disabled:h==="uploading"||h==="processing"}),e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-3 text-white shadow-lg shadow-blue-200",children:e.jsx(tt,{size:24})}),e.jsx("p",{className:"text-base font-bold text-gray-900",children:"Tap to Upload Photo"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG or PNG up to 25MB"})]}),(h==="uploading"||h==="processing")&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Stealing your t-shirt"}),e.jsxs("p",{className:"text-xs font-semibold text-blue-700",children:[M.percent,"%"]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2.5 overflow-hidden",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-500 ease-out",style:{width:`${M.percent}%`}})}),e.jsx("p",{className:"text-xs text-blue-700 mt-2",children:je[U]})]}),h==="error"&&C&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium text-red-900",children:["Error: ",C]}),e.jsx("button",{onClick:()=>{T("idle"),j(null),c(null)},className:"mt-2 text-xs text-red-700 underline",children:"Try again"})]}),h==="done"&&i&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-green-900 mb-3",children:"Extraction Complete!"}),e.jsx("p",{className:"text-xs text-green-700 mb-3",children:"Your extracted logo (click to open in new tab):"}),e.jsx("div",{className:"flex gap-3",children:(()=>{const s=I==="back"?a:o,t=s[s.length-1];return t?e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"block w-24 h-24 border-2 border-green-300 rounded-lg overflow-hidden bg-white hover:border-green-500 transition-all hover:scale-105",children:e.jsx("img",{src:t.url,alt:"Extracted artwork",className:"w-full h-full object-contain"})}):null})()}),e.jsx("button",{onClick:()=>{T("idle"),j(null),c(null)},className:"mt-3 text-xs text-green-700 underline",children:"Upload another image"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"T-Shirt Color"}),e.jsx("div",{className:"flex gap-6",children:Oe.map(s=>e.jsxs("button",{onClick:()=>q(s),className:"flex flex-col items-center gap-2 group",children:[e.jsx("div",{className:`w-12 h-12 rounded-full border-2 flex items-center justify-center transition-all ${x===s?"border-blue-500 scale-110":"border-gray-200"}`,children:e.jsx("div",{className:"w-10 h-10 rounded-full border border-gray-100 shadow-sm",style:{backgroundColor:s==="White"?"#FFFFFF":s==="Black"?"#000000":s==="Navy"?"#001f3f":s.toLowerCase()}})}),e.jsx("span",{className:`text-xs font-medium ${x===s?"text-black":"text-gray-500"}`,children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Size"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:Ce.map(s=>e.jsx("button",{onClick:()=>$(s),className:`py-3 rounded-lg text-sm font-medium transition-all ${R===s?"bg-black text-white shadow-md":"bg-white border border-gray-200 text-gray-700 hover:border-gray-300"}`,children:s},s))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 flex items-center justify-between",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Quantity"}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("button",{onClick:()=>Q(Math.max(1,P-1)),className:"w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center hover:bg-gray-300 transition-colors",children:e.jsx(Ze,{size:16})}),e.jsx("span",{className:"font-bold text-lg w-4 text-center",children:P}),e.jsx("button",{onClick:()=>Q(P+1),className:"w-8 h-8 rounded-full bg-black text-white flex items-center justify-center hover:bg-gray-800 transition-colors",children:e.jsx(et,{size:16})})]})]}),e.jsxs("div",{className:"flex justify-between items-center px-2 py-2 border-t border-gray-100",children:[e.jsx("span",{className:"text-gray-500",children:"Unit Price"}),e.jsxs("span",{className:"text-xl font-bold",children:["$",fe.toFixed(2)]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{onClick:Xe,disabled:!x||!R,className:"w-full bg-black text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-gray-200 hover:bg-gray-900 transition-all disabled:bg-gray-400 disabled:cursor-not-allowed",children:L?"Update Cart":"Add to Cart"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:xe,disabled:!ie,className:"py-3 rounded-xl border border-gray-200 font-medium flex items-center justify-center gap-2 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ve,{size:18})," Download"]}),e.jsxs("button",{onClick:be,className:"py-3 rounded-xl border border-gray-200 font-medium flex items-center justify-center gap-2 hover:bg-gray-50 transition-colors",children:[e.jsx(Ie,{size:18})," Save"]})]})]})]})})]}),e.jsx(Ge,{isOpen:Se,onClose:()=>pe(!1),onSave:ke,isUpdating:!!K,currentName:oe}),Le&&e.jsx(qe,{message:Re,type:"success",onClose:()=>ee(!1)})]})}function ht(){const{slug:v}=Fe(),[_,H]=n.useState(null),[W,w]=n.useState(!0),[B]=n.useState(null);return n.useEffect(()=>{if(!v)return;H(v==="classic-hoodie"?{product:{id:"2",title:"Classic Hoodie",slug:"classic-hoodie",description:"Premium heavyweight hoodie. Comfortable and perfect for custom designs.",images:["/assets/hoodie-black-front.png"],status:"active",variants:[{id:"10",product_id:"2",color:"Black",size:"S",sku:"HOODIE-BLK-S",base_price:35.99,stock_level:100},{id:"11",product_id:"2",color:"Black",size:"M",sku:"HOODIE-BLK-M",base_price:35.99,stock_level:100},{id:"12",product_id:"2",color:"Black",size:"L",sku:"HOODIE-BLK-L",base_price:35.99,stock_level:100},{id:"13",product_id:"2",color:"Black",size:"XL",sku:"HOODIE-BLK-XL",base_price:35.99,stock_level:100},{id:"14",product_id:"2",color:"Black",size:"2XL",sku:"HOODIE-BLK-2XL",base_price:35.99,stock_level:100},{id:"15",product_id:"2",color:"White",size:"S",sku:"HOODIE-WHT-S",base_price:35.99,stock_level:100},{id:"16",product_id:"2",color:"White",size:"M",sku:"HOODIE-WHT-M",base_price:35.99,stock_level:100},{id:"17",product_id:"2",color:"White",size:"L",sku:"HOODIE-WHT-L",base_price:35.99,stock_level:100},{id:"18",product_id:"2",color:"White",size:"XL",sku:"HOODIE-WHT-XL",base_price:35.99,stock_level:100},{id:"19",product_id:"2",color:"White",size:"2XL",sku:"HOODIE-WHT-2XL",base_price:35.99,stock_level:100}]},decorationMethods:[{id:"1",name:"dtg",display_name:"Direct to Garment",description:"Full-color digital printing",pricing_rules:{base_price:10,per_location:6,quantity_breaks:[{min:1,max:5,multiplier:1},{min:6,max:11,multiplier:.95},{min:12,max:null,multiplier:.85}]},file_requirements:{min_dpi:300,accepted_formats:["png","jpg","pdf"]}}]}:{product:{id:"1",title:"Classic Cotton T-Shirt",slug:"classic-tee",description:"Premium 100% cotton t-shirt. Soft, comfortable, and perfect for custom designs.",images:["/assets/blank-tshirt.png"],status:"active",variants:[{id:"1",product_id:"1",color:"White",size:"S",sku:"TEE-WHT-S",base_price:12.99,stock_level:100},{id:"2",product_id:"1",color:"White",size:"M",sku:"TEE-WHT-M",base_price:12.99,stock_level:100},{id:"3",product_id:"1",color:"White",size:"L",sku:"TEE-WHT-L",base_price:12.99,stock_level:100},{id:"4",product_id:"1",color:"White",size:"XL",sku:"TEE-WHT-XL",base_price:13.99,stock_level:100},{id:"5",product_id:"1",color:"White",size:"2XL",sku:"TEE-WHT-2XL",base_price:26.99,stock_level:100},{id:"6",product_id:"1",color:"Black",size:"S",sku:"TEE-BLK-S",base_price:12.99,stock_level:100},{id:"7",product_id:"1",color:"Black",size:"M",sku:"TEE-BLK-M",base_price:12.99,stock_level:100},{id:"8",product_id:"1",color:"Black",size:"L",sku:"TEE-BLK-L",base_price:12.99,stock_level:100},{id:"9",product_id:"1",color:"Black",size:"XL",sku:"TEE-BLK-XL",base_price:13.99,stock_level:100},{id:"10",product_id:"1",color:"Black",size:"2XL",sku:"TEE-BLK-2XL",base_price:26.99,stock_level:100},{id:"11",product_id:"1",color:"Navy",size:"S",sku:"TEE-NAV-S",base_price:12.99,stock_level:100},{id:"12",product_id:"1",color:"Navy",size:"M",sku:"TEE-NAV-M",base_price:12.99,stock_level:100},{id:"13",product_id:"1",color:"Navy",size:"L",sku:"TEE-NAV-L",base_price:12.99,stock_level:100},{id:"14",product_id:"1",color:"Navy",size:"XL",sku:"TEE-NAV-XL",base_price:13.99,stock_level:100},{id:"15",product_id:"1",color:"Navy",size:"2XL",sku:"TEE-NAV-2XL",base_price:26.99,stock_level:100}]},decorationMethods:[{id:"1",name:"dtg",display_name:"Direct to Garment",description:"Full-color digital printing",pricing_rules:{base_price:10,per_location:6,quantity_breaks:[{min:1,max:5,multiplier:1},{min:6,max:11,multiplier:.95},{min:12,max:null,multiplier:.85}]},file_requirements:{min_dpi:300,accepted_formats:["png","jpg","pdf"]}}]}),w(!1),We.getBySlug(v).then(D=>{D&&D.product&&H(D)}).catch(D=>{console.log("Using mock data, API unavailable:",D.message)})},[v]),W?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading product..."})]})}):B||!_?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-red-600 text-lg",children:B||"Product not found"})})}):e.jsx(nt,{product:_.product,variants:_.product.variants})}export{ht as default};
