import{j as e,u as ue,a as ze,b as Me,d as me,c as ke,p as He}from"./index-CPi0T1ow.js";import{r as n,R as We,e as Pe,f as Ue,L as _e,h as Fe}from"./react-vendor-Byl6S4M9.js";import{K as ge,S as Be,L as Ke,I as we,T as Ye}from"./canvas-vendor-C8lZMoyO.js";import{A as $e,S as Ge,H as Ve,a as qe,T as Je}from"./Toast-C8J3O8Iu.js";import{t as Qe,a as Ze}from"./analytics-o4OqUApf.js";import{U as et}from"./upload-ClHKDHCf.js";import"./auth-vendor-Cg5HAGal.js";const v={CONTAINER_MAX_WIDTH:600,CONTAINER_MAX_HEIGHT:700,ARTWORK_MAX_WIDTH:500,ARTWORK_MAX_HEIGHT:500,ARTWORK_MIN_SIZE:50,ARTWORK_MAX_RESIZE:800,EXPORT_PIXEL_RATIO_HIGH:3,EXPORT_PIXEL_RATIO_MEDIUM:2,EXPORT_PIXEL_RATIO_LOW:1,EXPORT_QUALITY_HIGH:1,EXPORT_QUALITY_MEDIUM:.9,EXPORT_QUALITY_LOW:.8},pe={FRONT:{minX:103,maxX:493,minY:100,maxY:550},BACK:{minX:140,maxX:510,minY:100,maxY:550},NECK:{minX:520,maxX:1080,minY:560,maxY:710}},Ne=n.forwardRef(({tshirtColor:w="white",artworks:k=[],onArtworkPositionChange:M,onArtworkDelete:H,view:_="front"},F)=>{const[T,C]=n.useState(null),[B,W]=n.useState([]),[X,S]=n.useState(null),K=n.useRef([]),G=n.useRef(null),x=n.useRef(null),q=n.useRef({front:null,back:null,neck:null}),L=n.useRef("front"),[Y,$]=n.useState({width:550,height:650});n.useImperativeHandle(F,()=>({downloadImage:async()=>{if(!x.current)return;S(null);const o=x.current,r=o.width(),a=o.height(),m=new ge.Layer,c=new window.Image;c.crossOrigin="anonymous",await new Promise(u=>{c.onload=()=>{const b=c.height/c.width*40,p=(r-40)/2,N=a-b-20,R=new ge.Image({image:c,x:p,y:N,width:40,height:b,opacity:1});m.add(R);const A=new ge.Text({x:0,y:N+b+3,width:r,text:"stolentee.com",fontSize:8,fontFamily:"Arial, sans-serif",fill:"#000000",align:"center",opacity:1});m.add(A),u()},c.src="/assets/stolentee-logo.png"}),o.add(m),m.moveToTop();const h=o.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_HIGH,mimeType:"image/png",quality:v.EXPORT_QUALITY_HIGH});m.destroy();const i=document.createElement("a");i.download="tshirt-design.png",i.href=h,document.body.appendChild(i),i.click(),document.body.removeChild(i)},getThumbnail:()=>x.current?x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_LOW,mimeType:"image/png",quality:v.EXPORT_QUALITY_LOW}):null,captureImage:()=>x.current?(S(null),x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_MEDIUM,mimeType:"image/png",quality:v.EXPORT_QUALITY_MEDIUM})):null,getThumbnailBlob:async()=>{if(!x.current)return null;const o=x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_LOW,mimeType:"image/png",quality:v.EXPORT_QUALITY_LOW});return await(await fetch(o)).blob()},deselect:()=>{S(null)}}));const J=o=>{const r=o.toLowerCase();return r==="navy"?{front:"/assets/navy-front.png",back:"/assets/navy-back.png",neck:"/assets/navy-neck.png"}:r==="black"?{front:"/assets/black-front.png",back:"/assets/black-back.png",neck:"/assets/black-neck.png"}:{front:"/assets/blank-tshirt.png",back:"/assets/back-tshirt.jpeg",neck:"/assets/neck-tshirt.jpeg"}};n.useEffect(()=>{const o=a=>new Promise(m=>{const c=new window.Image;c.src=a,c.crossOrigin="anonymous",c.onload=()=>m(c),c.onerror=()=>m(c)}),r=J(w);Promise.all([o(r.front),o(r.back),o(r.neck)]).then(([a,m,c])=>{q.current={front:a,back:m,neck:c};const h=_==="neck"?c:_==="back"?m:a;if(_==="neck"){const i=h.width/h.height,u=1600,I=950;let b=u,p=b/i;p<I&&(p=I,b=p*i),$({width:b,height:p})}else{const i=h.width/h.height,u=600,I=700;let b=u,p=u/i;if(p>I&&(p=I,b=I*i),_==="back"){const N=w?.toLowerCase()||"";N==="white"||N===""?(b=b*1.1,p=p*1.1):N==="navy"&&(b=b*1.02,p=p*1.02)}$({width:b,height:p})}C(h)})},[w,_]),n.useEffect(()=>{if(_===L.current)return;const o=q.current,r=_==="neck"?o.neck:_==="back"?o.back:o.front;if(r){if(_==="neck"){const a=r.width/r.height,m=1600,c=950;let h=m,i=h/a;i<c&&(i=c,h=i*a),$({width:h,height:i})}else{const a=r.width/r.height;let m=v.CONTAINER_MAX_WIDTH,c=v.CONTAINER_MAX_WIDTH/a;if(c>v.CONTAINER_MAX_HEIGHT&&(c=v.CONTAINER_MAX_HEIGHT,m=v.CONTAINER_MAX_HEIGHT*a),_==="back"){const h=w?.toLowerCase()||"";h==="white"||h===""?(m=m*1.1,c=c*1.1):h==="navy"&&(m=m*1.02,c=c*1.02)}$({width:m,height:c})}C(r),L.current=_}},[_]),n.useEffect(()=>{const o=r=>{if((r.key==="Delete"||r.key==="Backspace")&&X&&H){const a=parseInt(X.split("-")[1]);isNaN(a)||(H(a),S(null))}};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[X,H]);const P=n.useRef(new Map),ee=o=>{const r=document.createElement("canvas"),a=r.getContext("2d");if(!a)return o;r.width=o.width,r.height=o.height,a.drawImage(o,0,0);const c=a.getImageData(0,0,r.width,r.height).data;let h=r.width,i=r.height,u=0,I=0;for(let j=0;j<r.height;j++)for(let U=0;U<r.width;U++)c[(j*r.width+U)*4+3]>0&&(U<h&&(h=U),U>u&&(u=U),j<i&&(i=j),j>I&&(I=j));if(h>u||i>I)return o;const b=5;h=Math.max(0,h-b),i=Math.max(0,i-b),u=Math.min(r.width-1,u+b),I=Math.min(r.height-1,I+b);const p=u-h+1,N=I-i+1,R=document.createElement("canvas");R.width=p,R.height=N;const A=R.getContext("2d");if(!A)return o;A.drawImage(o,h,i,p,N,0,0,p,N);const z=new window.Image;return z.src=R.toDataURL("image/png"),z};n.useEffect(()=>{if(k.length===0){W([]),S(null),K.current=[];return}(async()=>{const r=k.map(a=>{const m=P.current.get(a.url);return m?Promise.resolve(m):new Promise((c,h)=>{const i=new window.Image;i.src=a.url,i.crossOrigin="anonymous",i.onload=()=>{const u=ee(i);u.complete?(P.current.set(a.url,u),c(u)):(u.onload=()=>{P.current.set(a.url,u),c(u)},u.onerror=()=>{P.current.set(a.url,i),c(i)})},i.onerror=h})});try{const a=await Promise.all(r);W(a),K.current=new Array(a.length).fill(null);const m=k[k.length-1];m&&!m.position&&S(`artwork-${k.length-1}`)}catch(a){console.error("Failed to load artworks:",a)}})()},[k]),n.useEffect(()=>{if(X&&G.current){const o=parseInt(X.split("-")[1]),r=K.current[o];r&&(G.current.nodes([r]),G.current.getLayer()?.batchDraw())}},[X]);const E=o=>{const r=K.current[o];r&&M&&M({x:r.x(),y:r.y(),scaleX:r.scaleX(),scaleY:r.scaleY(),rotation:r.rotation()},o)},Q=o=>{const r=o.target===o.target.getStage(),a=o.target.image===T;(r||a)&&S(null)};return e.jsx("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:e.jsxs("div",{className:"relative flex items-center justify-center",style:{transform:typeof window<"u"&&window.innerWidth<640?`scale(${Math.min(window.innerWidth/600,1)})`:"scale(1)",transformOrigin:"center center"},children:[B.length>0&&X&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-black/80 text-white text-xs px-4 py-2 rounded-full z-10",children:"Drag to move â€¢ Corners to resize â€¢ Rotate to spin â€¢ Click away to finish"}),B.length>0&&!X&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-gray-800/60 text-white text-xs px-4 py-2 rounded-full z-10",children:"Click artwork to edit position and size"}),e.jsx(Be,{ref:x,width:Y.width,height:Y.height,onMouseDown:Q,onTouchStart:Q,children:e.jsxs(Ke,{children:[T&&e.jsx(we,{image:T,x:0,y:0,width:Y.width,height:Y.height,onClick:()=>S(null),onTap:()=>S(null),..._==="neck"?{crop:{x:0,y:0,width:T.width,height:T.height}}:{}}),B.map((o,r)=>{const a=k[r];if(!a)return null;const m=o.width/o.height;let c=v.ARTWORK_MAX_WIDTH,h=v.ARTWORK_MAX_WIDTH/m;return h>v.ARTWORK_MAX_HEIGHT&&(h=v.ARTWORK_MAX_HEIGHT,c=v.ARTWORK_MAX_HEIGHT*m),e.jsxs(We.Fragment,{children:[e.jsx(we,{ref:i=>{K.current[r]=i},image:o,x:a.position?.x??(_==="neck"?750:200+r*20),y:a.position?.y??(_==="neck"?500:250+r*20),width:c,height:h,scaleX:a.position?.scaleX??1,scaleY:a.position?.scaleY??1,rotation:a.position?.rotation??0,draggable:!0,dragBoundFunc:i=>{const u=_==="neck"?pe.NECK:_==="back"?pe.BACK:pe.FRONT,I=K.current[r];if(!I)return i;const b=I.getClientRect(),p=b.width,N=b.height;let R=i.x,A=i.y;const z=b.x-I.x(),j=b.y-I.y();return R+z<u.minX&&(R=u.minX-z),R+z+p>u.maxX&&(R=u.maxX-p-z),A+j<u.minY&&(A=u.minY-j),A+j+N>u.maxY&&(A=u.maxY-N-j),{x:R,y:A}},onClick:()=>S(`artwork-${r}`),onTap:()=>S(`artwork-${r}`),onDragEnd:()=>E(r),onTransformEnd:()=>E(r)}),X===`artwork-${r}`&&e.jsx(Ye,{ref:G,keepRatio:!0,boundBoxFunc:(i,u)=>u.width<v.ARTWORK_MIN_SIZE||u.height<v.ARTWORK_MIN_SIZE||u.width>v.ARTWORK_MAX_RESIZE||u.height>v.ARTWORK_MAX_RESIZE?i:u,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],rotateEnabled:!0,borderStroke:"#000000",borderStrokeWidth:2,anchorSize:12,anchorStroke:"#000000",anchorFill:"#ffffff",anchorCornerRadius:6})]},`artwork-${r}`)})]})})]})})});Ne.displayName="TShirtCanvas";const ye=12.98,tt=5,st=(w,k,M,H)=>{let _=H;return[w,k].filter(Boolean).length===2&&(_+=tt),_},ve=["S","M","L","XL","2XL","3XL"],se=4,rt="http://localhost:3000",re=w=>w?w.startsWith("http")?w:`${rt}${w}`:"",Ie=["This is AI-powered extraction. Multiple attempts may be needed for perfect results.","Brand names may be altered due to copyright restrictions and AI safety filters.","Complex designs with multiple layers may require several tries to extract perfectly.","Trademarked logos and brand text might be regenerated differently by the AI."];function ot({product:w,variants:k}){const M=Pe(),H=ue(s=>s.addItem),_=ue(s=>s.updateItem),F=ue(s=>s.getItem),T=n.useRef(null),{isAuthenticated:C}=ze(),[B]=Ue(),[W,X]=n.useState(null),[S,K]=n.useState(null),G=n.useRef(null),[x,q]=n.useState(""),[L,Y]=n.useState(""),[$,J]=n.useState(null),[P,ee]=n.useState(1),[E,Q]=n.useState("front"),[o,r]=n.useState([]),[a,m]=n.useState([]),[c,h]=n.useState(null),[i,u]=n.useState(null),[I,b]=n.useState("front"),[p,N]=n.useState("idle"),[R,A]=n.useState(null),[z,j]=n.useState({message:"",percent:0}),[U,he]=n.useState(0),[oe,Te]=n.useState(null),[Ee,fe]=n.useState(!1),[ae,ne]=n.useState(""),[Ae,Z]=n.useState(!1),[je,te]=n.useState("");n.useEffect(()=>{Qe(w.title)},[]),n.useEffect(()=>{if(p==="uploading"||p==="processing"){const s=setInterval(()=>{he(t=>(t+1)%Ie.length)},4e3);return()=>clearInterval(s)}},[p]);const ie=()=>E==="front"?o:E==="back"?a:[],xe=ie()[0]||null,le=st(o.length>0,a.length>0,!1,ye),ce=[...new Set(k.map(s=>s.color))],Se=ce.includes("Navy")?ce:[...ce,"Navy"],Le=[...new Set(k.map(s=>s.size))].sort((s,t)=>ve.indexOf(s)-ve.indexOf(t));n.useEffect(()=>{if(x&&L){const s=k.find(t=>t.color===x&&t.size===L);J(s||null)}},[x,L,k]),n.useEffect(()=>{const s=B.get("designId");s&&C&&k.length>0&&G.current!==s&&(G.current=s,Re(s))},[B,C,k]),n.useEffect(()=>{const s=B.get("editCartItem");if(s){const t=F(s);t&&(K(s),q(t.variantColor),Y(t.variantSize),ee(t.quantity),t.customization&&(t.customization.frontArtworks&&r(t.customization.frontArtworks),t.customization.backArtworks&&m(t.customization.backArtworks),t.customization.neckArtwork&&h(t.customization.neckArtwork)))}},[B,F]),n.useEffect(()=>{if(!i||p!=="processing")return;let s=15;const t=setInterval(async()=>{try{const d=await Me.getStatus(i);if(console.log("Job status:",d),d.status==="running"&&d.logs){const l=d.logs.toLowerCase();l.includes("step 1")||l.includes("gemini")?s=35:l.includes("step 2")||l.includes("background")?s=60:l.includes("step 3")||l.includes("dpi")?s=80:(l.includes("step 4")||l.includes("verifying"))&&(s=95)}if(d.status==="done"){N("done"),j({message:"Complete!",percent:100}),clearInterval(t);const l=d.assets?.find(y=>y.kind==="transparent");if(l){const y=re(l.file_url);Te(y);const O={url:y,position:null,assetId:l.id};I==="back"?a.length>=se?A(`Maximum ${se} artworks per view. Remove one first.`):m(f=>[...f,O]):o.length>=se?A(`Maximum ${se} artworks per view. Remove one first.`):r(f=>[...f,O])}}else d.status==="failed"&&(N("error"),A(d.errorMessage||"Extraction failed"),clearInterval(t))}catch(d){console.error("Failed to poll job status:",d),console.error("Error details:",d.response?.data||d.message),N("error"),A(d.response?.data?.message||d.message||"Failed to check extraction status"),clearInterval(t)}},2e3),g=setInterval(()=>{j(d=>{if(d.percent<s){const l=Math.min(2,s-d.percent);return{message:"Stealing your t-shirt",percent:d.percent+l}}return d})},100);return()=>{clearInterval(t),clearInterval(g)}},[i,p]);const Re=async s=>{try{const t=await me.getById(s);console.log("[LOAD] Full design object:",JSON.stringify(t,null,2)),X(t.id),ne(t.name);const g=t.artwork_ids||[],d=t.artwork_urls||{};let l=0;if(t.design_data){if(t.design_data.front&&t.design_data.front.length>0){const f=t.design_data.front.map(D=>{const V=g[l],de=V?re(d[V]):"";return l++,{url:de||"",position:D,assetId:V}});r(f)}if(t.design_data.back&&t.design_data.back.length>0){const f=t.design_data.back.map(D=>{const V=g[l],de=V?re(d[V]):"";return l++,{url:de||"",position:D,assetId:V}});m(f)}if(t.design_data.neck&&t.design_data.neck.length>0){const f=g[l],D=f?re(d[f]):"";h({url:D||"",position:t.design_data.neck[0],assetId:f})}}console.log("[LOAD] Design variant_id:",t.variant_id),console.log("[LOAD] Design variant_color:",t.variant_color),console.log("[LOAD] Design variant_size:",t.variant_size),console.log("[LOAD] Design data color/size:",t.design_data?.selectedColor,t.design_data?.selectedSize);let y=null,O=null;if(t.design_data?.selectedColor){console.log("[LOAD] Using color from design_data (highest priority):",t.design_data.selectedColor),y=t.design_data.selectedColor,O=t.design_data.selectedSize||"M";const f=k.find(D=>D.color===y&&D.size===O);f?(console.log("[LOAD] Found matching variant for design_data color:",f),J(f)):console.log("[LOAD] No variant found for color:",y,"(UI-only color like Navy)")}else if(t.variant_id){let f=k.find(D=>D.id===t.variant_id);console.log("[LOAD] Found variant by ID:",f),!f&&t.variant_color&&t.variant_size&&(console.log("[LOAD] Variant ID not found, trying color/size lookup:",t.variant_color,t.variant_size),f=k.find(D=>D.color===t.variant_color&&D.size===t.variant_size),console.log("[LOAD] Found variant by color/size:",f)),f?(console.log("[LOAD] Setting color/size/variant from variant:",f.color,f.size),y=f.color,O=f.size,J(f)):t.variant_color&&(console.log("[LOAD] No variant found, using color from JOIN:",t.variant_color),y=t.variant_color,O=t.variant_size)}y&&(q(y),Y(O||"M"))}catch(t){console.error("Error loading design:",t),alert("Failed to load design")}},Oe=async s=>{const t=s.target.files?.[0];if(t){A(null);try{b(E),N("uploading"),j({message:"Uploading your image...",percent:5});const{asset:g,jobId:d,message:l}=await ke.uploadShirtPhoto(t);console.log("Shirt photo uploaded:",{asset:g,jobId:d,message:l}),u(d),N("processing"),j({message:"Starting extraction process...",percent:15}),s.target.value=""}catch(g){console.error("Shirt photo upload failed:",g),N("error"),A(g.response?.data?.message||"Failed to upload shirt photo"),s.target.value=""}}},De=async()=>{T.current&&T.current.downloadImage&&await T.current.downloadImage()},Ce=async()=>{if(!C){M("/login",{state:{from:window.location.pathname+window.location.search}});return}if(W&&ae){try{await be(ae),te("Design updated successfully!"),Z(!0),setTimeout(()=>Z(!1),3e3)}catch(s){console.error("Error updating design:",s),alert("Failed to update design")}return}fe(!0)},be=async s=>{try{const t={front:o.map(l=>l.position),back:a.map(l=>l.position),neck:c?[c.position]:[],selectedColor:x,selectedSize:L||"M"},g=[...o.filter(l=>l.assetId).map(l=>l.assetId),...a.filter(l=>l.assetId).map(l=>l.assetId),...c?.assetId?[c.assetId]:[]];let d="";if(T.current&&T.current.getThumbnailBlob)try{const l=await T.current.getThumbnailBlob();if(l){const y=new File([l],"thumbnail.png",{type:"image/png"});d=(await ke.uploadFile(y)).file_url}}catch(l){console.error("Failed to capture thumbnail:",l)}if(W){const l=L||"M",y=$||(x?k.find(O=>O.color===x&&O.size===l):null);console.log("[SAVE] Updating design with variant:",{variantId:y?.id,color:x,size:L,variant:y}),await me.update(W,{name:s,variantId:y?.id,designData:t,artworkIds:g,thumbnailUrl:d}),ne(s)}else{const l=L||"M",y=$||(x?k.find(f=>f.color===x&&f.size===l):null);console.log("[SAVE] Saving new design with variant:",{variantId:y?.id,color:x,size:L,variant:y});const O=await me.save({name:s,productId:w.id,variantId:y?.id,designData:t,artworkIds:g,thumbnailUrl:d});X(O.id),ne(s),Ze(s)}}catch(t){throw console.error("Error saving design:",t),t}},Xe=()=>{if(!x||!L){te("Please select a color and size"),Z(!0);return}let s;try{T.current&&T.current.captureImage&&(s=T.current.captureImage())}catch(d){console.error("Error capturing mockup:",d)}const t=$||{id:`temp-${x}-${L}`},g={id:S||`${t.id}-${Date.now()}`,variantId:t.id,productTitle:w.title,variantColor:x,variantSize:L,quantity:P,unitPrice:le,customization:{method:"dtg",frontArtworks:o,backArtworks:a,neckArtwork:c},mockupUrl:s};S?(_(S,g),te("Cart item updated successfully!")):(H(g),te("Added to cart successfully!")),Z(!0),setTimeout(()=>{M("/cart")},1500)};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("div",{className:"border-b border-gray-200 bg-white sticky top-0 z-50",children:e.jsxs("div",{className:"relative px-3 sm:px-6 py-3 sm:py-1.5 flex items-center justify-between",children:[e.jsx("div",{className:"hidden sm:block text-sm font-bold min-w-0",children:w.title}),e.jsx(_e,{to:"/",className:"sm:hidden text-sm font-medium text-gray-600 hover:text-gray-900",children:"â† Back"}),e.jsx(_e,{to:"/",className:"hidden sm:block absolute left-1/2 -translate-x-1/2 text-lg font-bold hover:text-gray-600 transition-colors",children:"Stolen Tee"}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:De,disabled:!xe,title:"Download Design",className:`hidden sm:flex p-2 rounded-md transition-colors ${xe?"text-gray-700 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,children:e.jsx($e,{size:18})}),e.jsxs("button",{onClick:Ce,className:"flex items-center gap-1.5 px-3 sm:px-4 py-2 sm:py-1.5 text-xs font-medium rounded-md transition-colors bg-black text-white hover:bg-gray-800",children:[e.jsx(Ge,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:W?"Update":"Save"}),e.jsx("span",{className:"sm:hidden",children:W?"Update":"Save"})]}),e.jsxs("div",{className:"hidden md:block text-sm font-normal whitespace-nowrap",children:["from $",ye.toFixed(2)]})]})]})}),e.jsxs("div",{className:"flex h-[calc(100vh-60px)]",children:[e.jsx("div",{className:"w-1/4 bg-gray-50 border-r border-gray-200 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Upload Shirt Photo"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Upload a photo of your shirt and we'll extract the design automatically"}),e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-900",children:"This is done using AI, and sometimes it requires multiple tries to get your perfect, desired result."})}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors cursor-pointer bg-white",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/png",onChange:Oe,className:"hidden",id:"shirt-photo-upload",disabled:p==="uploading"||p==="processing"}),e.jsxs("label",{htmlFor:"shirt-photo-upload",className:"cursor-pointer",children:[e.jsx(et,{className:"mx-auto mb-3 text-gray-400",size:36}),e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG or PNG up to 25MB"})]})]}),(p==="uploading"||p==="processing")&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Stealing your t-shirt"}),e.jsxs("p",{className:"text-xs font-semibold text-blue-700",children:[z.percent,"%"]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2.5 overflow-hidden",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-500 ease-out",style:{width:`${z.percent}%`}})})]}),e.jsx("p",{className:"text-xs text-blue-700 transition-opacity duration-300",children:Ie[U]})]}),p==="done"&&e.jsx("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Logo extracted successfully! You can now position it on the shirt."})}),p==="error"&&R&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium text-red-900",children:["Error: ",R]}),e.jsx("button",{onClick:()=>{N("idle"),A(null),u(null)},className:"mt-2 text-xs text-red-700 underline hover:text-red-900",children:"Try again"})]}),oe&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Your Artwork File"}),e.jsx("div",{className:"bg-white border-2 border-green-300 rounded-lg p-3 hover:border-green-400 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-16 h-16 bg-gray-100 rounded border border-gray-200 overflow-hidden",style:{backgroundImage:"repeating-conic-gradient(#f0f0f0 0% 25%, transparent 0% 50%) 50% / 10px 10px"},children:e.jsx("img",{src:oe,alt:"Extracted artwork",className:"w-full h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Print-Ready Artwork"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"300 DPI"})]}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Transparent PNG Â· Ready for printing"}),e.jsxs("a",{href:oe,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs font-medium text-blue-600 hover:text-blue-800",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"View Full Size"]})]})]})}),e.jsx("p",{className:"text-xs text-gray-500 italic mt-2",children:'ðŸ’¡ Click "View Full Size" to inspect the print file that will be sent to production'})]}),e.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-6",children:[e.jsx("label",{className:"block text-sm font-semibold mb-4",children:"Garment Color"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Se.map(s=>e.jsxs("button",{onClick:()=>q(s),className:`flex items-center gap-3 p-3 rounded-lg border-2 transition-all ${x===s?"border-black bg-gray-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full border border-gray-300",style:{backgroundColor:s==="White"?"#FFFFFF":s==="Black"?"#000000":s==="Navy"?"#001f3f":s.toLowerCase()}}),e.jsx("span",{className:"text-sm font-medium",children:s})]},s))})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[e.jsx("label",{className:"block text-sm font-semibold mb-4",children:"Size"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:Le.map(s=>e.jsx("button",{onClick:()=>Y(s),className:`px-4 py-3 border-2 rounded-lg text-sm font-medium transition-all ${L===s?"border-black bg-black text-white":"border-gray-200 hover:border-gray-300"}`,children:s},s))})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[e.jsx("label",{className:"block text-sm font-semibold mb-4",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:P,onChange:s=>ee(parseInt(s.target.value)||1),className:"w-full px-4 py-3 text-base border-2 border-gray-200 rounded-lg focus:outline-none focus:border-black"})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Unit Price"}),e.jsxs("span",{className:"text-lg font-semibold",children:["$",le.toFixed(2)]})]}),P>=2&&e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",(le*P).toFixed(2)]})]})]}),e.jsx("div",{className:"pt-6",children:e.jsx("button",{onClick:Xe,disabled:!x||!L,className:"w-full py-3.5 sm:py-3 bg-black text-white text-base sm:text-sm font-medium rounded-full hover:bg-gray-800 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:S?"Update Cart":"Add to Cart"})})]})}),e.jsxs("div",{className:"w-3/4 bg-white flex flex-col relative overflow-hidden",children:[e.jsx("div",{className:"h-full flex items-center justify-center pt-2 pb-16 px-6",children:w.slug==="classic-hoodie"?e.jsx(Ve,{ref:T,artworks:ie(),view:E,onArtworkPositionChange:(s,t)=>{if(E==="front"){const g=[...o];g[t]={...g[t],position:s},r(g)}else if(E==="back"){const g=[...a];g[t]={...g[t],position:s},m(g)}},onArtworkDelete:s=>{if(E==="front"){const t=o.filter((g,d)=>d!==s);r(t)}else if(E==="back"){const t=a.filter((g,d)=>d!==s);m(t)}}}):e.jsx(Ne,{ref:T,tshirtColor:x,artworks:ie(),view:E,onArtworkPositionChange:(s,t)=>{if(E==="front"){const g=[...o];g[t]={...g[t],position:s},r(g)}else if(E==="back"){const g=[...a];g[t]={...g[t],position:s},m(g)}},onArtworkDelete:s=>{if(E==="front"){const t=o.filter((g,d)=>d!==s);r(t)}else if(E==="back"){const t=a.filter((g,d)=>d!==s);m(t)}}})}),e.jsxs("div",{className:"absolute bottom-4 lg:bottom-8 left-1/2 -translate-x-1/2 bg-white rounded-full shadow-lg px-1.5 sm:px-2 py-1.5 sm:py-2 flex gap-1",children:[e.jsx("button",{onClick:()=>Q("front"),className:`px-4 sm:px-5 py-2.5 sm:py-2 rounded-full text-sm font-medium transition-colors ${E==="front"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Front"}),e.jsx("button",{onClick:()=>Q("back"),className:`px-4 sm:px-5 py-2.5 sm:py-2 rounded-full text-sm font-medium transition-colors ${E==="back"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Back"})]})]})]}),e.jsx(qe,{isOpen:Ee,onClose:()=>fe(!1),onSave:be,isUpdating:!!W,currentName:ae}),Ae&&e.jsx(Je,{message:je,type:"success",onClose:()=>Z(!1)})]})}function mt(){const{slug:w}=Fe(),[k,M]=n.useState(null),[H,_]=n.useState(!0),[F]=n.useState(null);return n.useEffect(()=>{if(!w)return;M(w==="classic-hoodie"?{product:{id:"2",title:"Classic Hoodie",slug:"classic-hoodie",description:"Premium heavyweight hoodie. Comfortable and perfect for custom designs.",images:["/assets/hoodie-black-front.png"],status:"active",variants:[{id:"10",product_id:"2",color:"Black",size:"S",sku:"HOODIE-BLK-S",base_price:35.99,stock_level:100},{id:"11",product_id:"2",color:"Black",size:"M",sku:"HOODIE-BLK-M",base_price:35.99,stock_level:100},{id:"12",product_id:"2",color:"Black",size:"L",sku:"HOODIE-BLK-L",base_price:35.99,stock_level:100},{id:"13",product_id:"2",color:"Black",size:"XL",sku:"HOODIE-BLK-XL",base_price:35.99,stock_level:100},{id:"14",product_id:"2",color:"Black",size:"2XL",sku:"HOODIE-BLK-2XL",base_price:35.99,stock_level:100},{id:"15",product_id:"2",color:"White",size:"S",sku:"HOODIE-WHT-S",base_price:35.99,stock_level:100},{id:"16",product_id:"2",color:"White",size:"M",sku:"HOODIE-WHT-M",base_price:35.99,stock_level:100},{id:"17",product_id:"2",color:"White",size:"L",sku:"HOODIE-WHT-L",base_price:35.99,stock_level:100},{id:"18",product_id:"2",color:"White",size:"XL",sku:"HOODIE-WHT-XL",base_price:35.99,stock_level:100},{id:"19",product_id:"2",color:"White",size:"2XL",sku:"HOODIE-WHT-2XL",base_price:35.99,stock_level:100}]},decorationMethods:[{id:"1",name:"dtg",display_name:"Direct to Garment",description:"Full-color digital printing",pricing_rules:{base_price:10,per_location:6,quantity_breaks:[{min:1,max:5,multiplier:1},{min:6,max:11,multiplier:.95},{min:12,max:null,multiplier:.85}]},file_requirements:{min_dpi:300,accepted_formats:["png","jpg","pdf"]}}]}:{product:{id:"1",title:"Classic Cotton T-Shirt",slug:"classic-tee",description:"Premium 100% cotton t-shirt. Soft, comfortable, and perfect for custom designs.",images:["/assets/blank-tshirt.png"],status:"active",variants:[{id:"1",product_id:"1",color:"White",size:"S",sku:"TEE-WHT-S",base_price:12.99,stock_level:100},{id:"2",product_id:"1",color:"White",size:"M",sku:"TEE-WHT-M",base_price:12.99,stock_level:100},{id:"3",product_id:"1",color:"White",size:"L",sku:"TEE-WHT-L",base_price:12.99,stock_level:100},{id:"4",product_id:"1",color:"White",size:"XL",sku:"TEE-WHT-XL",base_price:13.99,stock_level:100},{id:"5",product_id:"1",color:"White",size:"2XL",sku:"TEE-WHT-2XL",base_price:26.99,stock_level:100},{id:"6",product_id:"1",color:"Black",size:"S",sku:"TEE-BLK-S",base_price:12.99,stock_level:100},{id:"7",product_id:"1",color:"Black",size:"M",sku:"TEE-BLK-M",base_price:12.99,stock_level:100},{id:"8",product_id:"1",color:"Black",size:"L",sku:"TEE-BLK-L",base_price:12.99,stock_level:100},{id:"9",product_id:"1",color:"Black",size:"XL",sku:"TEE-BLK-XL",base_price:13.99,stock_level:100},{id:"10",product_id:"1",color:"Black",size:"2XL",sku:"TEE-BLK-2XL",base_price:26.99,stock_level:100},{id:"11",product_id:"1",color:"Navy",size:"S",sku:"TEE-NAV-S",base_price:12.99,stock_level:100},{id:"12",product_id:"1",color:"Navy",size:"M",sku:"TEE-NAV-M",base_price:12.99,stock_level:100},{id:"13",product_id:"1",color:"Navy",size:"L",sku:"TEE-NAV-L",base_price:12.99,stock_level:100},{id:"14",product_id:"1",color:"Navy",size:"XL",sku:"TEE-NAV-XL",base_price:13.99,stock_level:100},{id:"15",product_id:"1",color:"Navy",size:"2XL",sku:"TEE-NAV-2XL",base_price:26.99,stock_level:100}]},decorationMethods:[{id:"1",name:"dtg",display_name:"Direct to Garment",description:"Full-color digital printing",pricing_rules:{base_price:10,per_location:6,quantity_breaks:[{min:1,max:5,multiplier:1},{min:6,max:11,multiplier:.95},{min:12,max:null,multiplier:.85}]},file_requirements:{min_dpi:300,accepted_formats:["png","jpg","pdf"]}}]}),_(!1),He.getBySlug(w).then(C=>{C&&C.product&&M(C)}).catch(C=>{console.log("Using mock data, API unavailable:",C.message)})},[w]),H?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading product..."})]})}):F||!k?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-red-600 text-lg",children:F||"Product not found"})})}):e.jsx(ot,{product:k.product,variants:k.product.variants})}export{mt as default};
